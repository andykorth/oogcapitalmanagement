<style>
  #intel-tool {
    margin: 0 auto;
    text-align: left;
    padding: 1rem;
  }

  #intel-tool .inputs {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 0.8rem;
  }

  #intel-tool .input-row span {
    flex: 0 0 130px;
    text-align: right;
    margin-right: 0.5rem;
  }

  #intel-tool input {
    flex: 1;
  }

  #intelStatus {
    color: rgb(156 163 175);
    font-size: 0.9rem;
    margin-top: 0.5rem;
  }

  .section {
    margin-top: 0.5rem;
  }

  .section h3 {
    border-bottom: 2px solid #555;
    padding-bottom: 4px;
    margin-bottom: 8px;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 0.5rem;
  }

  th, td {
    border: 1px solid #333;
  }

  th {
    background-color: #222;
    color: #ddd;
  }

  /* New: Layout for overview + planets */
  .info-flex {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
  }

  .info-left, .info-right {
    flex: 1 1 45%;
    min-width: 300px;
  }

  .info-right {
    max-width: 300px;
  }

  /* Highlight "Current" offices */
  #officeTable td.status-current {
    background-color: rgba(34, 197, 94, 0.25); /* Tailwind green-500 at low opacity */
    color: rgb(34 197 94); /* Tailwind green-500 text */
    font-weight: 600;
    border-radius: 4px;
  }

  #companyTable th {
    max-width: 200px;
  }

  .text-green-400 {
        color: rgb(34 197 94); /* Tailwind green-500 text */
  }
  .text-red-400 {
        color: rgb(197 34 94); /* Tailwind green-500 text */
  }

</style>

<div id="intel-tool" class="calculator">
  <div class="inputs">
    <div class="input-row">
      <span>Company Code:</span>
      <input id="companyCodeInput" type="text" placeholder="e.g. ARCL" />
      <button id="fetchCompanyButton">Fetch</button>
    </div>
  </div>

  <div id="intelStatus"></div>

  <div id="companyInfo" class="hidden">
    <div class="info-flex">
      <div class="info-left section">
        <h3>Company Overview</h3>
        <table id="companyTable"><tbody></tbody></table>
      </div>
    </div>

    <div id="reportSection" class="mt-6">
      <h2 class="text-xl font-semibold mb-2">Company Production Overview</h2>
      <div id="reportContainer" class="w-full h-[700px] rounded-lg overflow-hidden border border-gray-600">
        <!-- iframe will be inserted here -->
      </div>
    </div>

    <div class="info-flex">
      <div class="section info-left" id="officeSection">
        <h3>Active Offices</h3>
        <table id="officeTable">
          <thead><tr><th>Planet Name</th><th>Count</th><th>Status</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
      <div class="info-right section">
        <h3>Owned Planets (ever)</h3>
        <table id="planetTable">
          <thead><tr><th>Planet Name</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

    <div id="exchangeSection" class="mt-6">
      <h2 class="text-xl font-semibold mb-2">Exchange Orders</h2>
      <div id="exchangeTableContainer" class="overflow-x-auto">
        <table id="exchangeTable" class="min-w-full text-sm border-collapse border border-gray-600">
          <!-- Populated dynamically -->
        </table>
      </div>
    </div>

  </div>
</div>

<script type="module" src="/intel-lookup.js"></script>
