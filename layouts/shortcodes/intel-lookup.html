<style>
  #intel-tool {
    margin: 0 auto;
    text-align: left;
    padding: 1rem;
  }

  /* Section bands */
  .intel-section {
    margin-top: 1.5rem;
    padding: 0.75rem 1rem 1rem;
    border-radius: 6px;
    border-left: 3px solid rgb(99 102 241);
    background: rgba(99, 102, 241, 0.06);
  }
  .section-label {
    font-size: 0.7rem;
    font-weight: 700;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--text-secondary);
    margin-bottom: 0.75rem;
  }

  /* Company header card */
  .company-header-card {
    margin-top: 1rem;
    padding: 1rem 1.25rem;
    border-radius: 8px;
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
  }
  .company-card-name {
    font-size: 1.4rem;
    font-weight: 700;
    margin-bottom: 0.2rem;
  }
  .company-card-code {
    font-weight: 400;
    color: var(--text-secondary);
    margin-left: 0.35rem;
  }
  .company-card-meta {
    font-size: 0.88rem;
    color: var(--text-secondary);
    margin-bottom: 0.15rem;
  }
  .company-card-badges {
    margin-top: 0.6rem;
    display: flex;
    gap: 0.4rem;
    flex-wrap: wrap;
    align-items: center;
  }
  .intel-badge {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 4px;
    font-size: 0.72rem;
    font-weight: 700;
    letter-spacing: 0.04em;
  }
  .badge-tier   { background: rgba(99,102,241,0.2); color: rgb(129 140 248); }
  .badge-sub    { background: rgba(16,185,129,0.2); color: rgb(52 211 153); }
  .badge-rating { background: rgba(251,191,36,0.2); color: rgb(251 191 36); }

  /* Cache indicator */
  .cache-indicator {
    font-size: 0.8rem;
    color: var(--text-secondary);
    margin-top: 0.4rem;
  }
  .cache-refresh {
    cursor: pointer;
    color: rgb(129 140 248);
    margin-left: 0.5rem;
    text-decoration: underline;
  }
  .cache-refresh:hover { color: rgb(165 180 252); }

  /* Scope border to this tool only */
  #intel-tool th,
  #intel-tool td {
    border: 1px solid var(--border-color);
  }
  #companyTable th { max-width: 200px; }

  /* Offices: highlight active rows */
  #officeTable tr.office-active td { color: #4ade80; font-weight: 600; }

  /* Presence section layout */
  .info-flex {
    display: flex;
    gap: 1.5rem;
    flex-wrap: wrap;
    align-items: flex-start;
  }
  .info-left  { flex: 1 1 55%; min-width: 280px; }
  .info-right { flex: 0 1 260px; min-width: 180px; }

  /* iframe container */
  #reportContainer { border-radius: 8px; overflow: hidden; }

  /* Exchange table buy/sell colors */
  .text-buy  { color: #4ade80; }
  .text-sell { color: #f87171; }
</style>

<div id="intel-tool" class="calculator">
  <div class="inputs">
    <div class="input-row">
      <span>Company Code:</span>
      <input id="companyCodeInput" type="text" placeholder="e.g. ARCL" />
    </div>
    <div class="input-row">
      <button id="fetchCompanyButton">Fetch</button>
    </div>
  </div>

  <div id="intelStatus" class="tool-status"></div>

  <div id="companyInfo" class="hidden">

    <div id="companyHeader" class="company-header-card"></div>
    <div id="cacheIndicator" class="cache-indicator"></div>

    <div class="intel-section">
      <div class="section-label">Company Overview</div>
      <table id="companyTable"><tbody></tbody></table>
    </div>

    <div class="intel-section">
      <div class="section-label">Production Charts</div>
      <div id="reportContainer"></div>
    </div>

    <div class="intel-section">
      <div class="section-label">Presence</div>
      <div class="info-flex">
        <div class="info-left" id="officeSection">
          <h3 class="mb-2 font-bold">Offices</h3>
          <table id="officeTable">
            <thead><tr><th>Planet</th><th>Offices Held</th><th>Expires</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="info-right">
          <h3 class="mb-2 font-bold">Planets with Bases</h3>
          <table id="planetTable">
            <thead><tr><th>Planet</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="intel-section">
      <div class="section-label">Exchange Orders</div>
      <div id="exchangeTableContainer" style="overflow-x:auto">
        <table id="exchangeTable" class="text-sm border-collapse"></table>
      </div>
    </div>

  </div>
</div>

<script type="module" src="/intel-lookup.js"></script>
